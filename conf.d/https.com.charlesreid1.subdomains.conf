####################
#
# charlesreid1.com subdomains
# redirecting to blackbeard:
# - pages
# - hooks
# - bots
#
# krash = 45.56.87.232
# blackbeard = 54.191.178.27
#
####################

#server {
#    listen 443;
#    listen [::]:443;
#    server_name pages.charlesreid1.com;
#
#    ssl on;
#    ssl_certificate /etc/letsencrypt/live/pages.charlesreid1.com/fullchain.pem;
#    ssl_certificate_key /etc/letsencrypt/live/pages.charlesreid1.com/privkey.pem;
#    include /etc/letsencrypt/options-ssl-nginx.conf;
#
#    client_max_body_size 100m;
#    port_in_redirect off;
#
#    location / {
#        # https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/
#        proxy_set_header X-Real-IP  $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#        proxy_set_header Host $host;
#        proxy_pass http://54.191.178.27:7777/;
#        proxy_redirect http://54.191.178.27:7777/ http://pages.charlesreid1.com/;
#    }
#}

server {
    listen 443;
    listen [::]:443;
    server_name hooks.charlesreid1.com;

    ssl on;
    ssl_certificate /etc/letsencrypt/live/hooks.charlesreid1.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/hooks.charlesreid1.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;

    client_max_body_size 100m;

    gzip              on;
    gzip_http_version 1.0;
    gzip_proxied      any;
    gzip_min_length   500;
    gzip_disable      "MSIE [1-6]\.";
    gzip_types        text/plain text/xml text/css
                      text/comma-separated-values
                      text/javascript
                      application/x-javascript
                      application/atom+xml;

    location / {
        # / takes user to static hooks subdomain page
        proxy_set_header X-Real-IP  $remote_addr;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_set_header Host $host;
        proxy_pass http://54.191.178.27:7778;
    }

    location /webhook {
        # /webhook* anything takes user to port 5000, api
        proxy_set_header   X-Real-IP  $remote_addr;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   Host $host;
        proxy_pass http://54.191.178.27:5000/webhook;
    }
}

server {
    # https://bots.charlesreid1.com
    listen 443;
    listen [::]:443;
    server_name bots.charlesreid1.com;

    ssl on;
    ssl_certificate /etc/letsencrypt/live/bots.charlesreid1.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/bots.charlesreid1.com/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;

    client_max_body_size 100m;
    port_in_redirect off;

    location / {
        proxy_set_header X-Real-IP  $remote_addr;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_set_header Host $host;
        proxy_pass http://54.191.178.27:7779;
        proxy_redirect http://54.191.178.27:7779/ http://bots.charlesreid1.com/;
    }
}

#server {
#    listen 443;
#    listen [::]:443;
#    server_name api.charlesreid1.com;
#
#    ssl on;
#    ssl_certificate /etc/letsencrypt/live/api.charlesreid1.com/fullchain.pem;
#    ssl_certificate_key /etc/letsencrypt/live/api.charlesreid1.com/privkey.pem;
#    include /etc/letsencrypt/options-ssl-nginx.conf;
#
#    client_max_body_size 100m;
#
#    location / {
#        # / takes user to static api subdomain page
#        proxy_set_header X-Real-IP  $remote_addr;
#        proxy_set_header X-Forwarded-For $remote_addr;
#        proxy_set_header Host $host;
#        proxy_pass http://54.191.178.27:7780;
#    }
#
#    #location ~ ^/[a-zA-Z0-9].* {
#    #    # /anything else takes user to port 5000, api
#    #    proxy_set_header X-Real-IP  $remote_addr;
#    #    proxy_set_header X-Forwarded-Host $host:$server_port;
#    #    proxy_set_header X-Forwarded-Server $host;
#    #    proxy_set_header X-Forwarded-For $remote_addr;
#    #    proxy_set_header Host $host;
#    #    proxy_pass http://54.191.178.27:5000;
#    #}
#
#}

